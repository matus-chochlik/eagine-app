#!/bin/bash
# Copyright Matus Chochlik.
# Distributed under the Boost Software License, Version 1.0.
# See accompanying file LICENSE_1_0.txt or copy at
#  http://www.boost.org/LICENSE_1_0.txt
#
src_dir=$(realpath "@SRC_DIR@")
bin_dir=$(realpath "@BIN_DIR@")
pkg_dir=$(realpath "@PKG_DIR@")

mkdir -p "${pkg_dir}/usr"
pkg_prefix=$(realpath "@PKG_DIR@/usr")
bin_prefix="${pkg_prefix}/bin"
bco_prefix="${pkg_dir}/etc/bash_completion.d"

# ------------------------------------------------------------------------------
mkdir -p "${bin_prefix}"
mkdir -p "${bco_prefix}"

cp "${src_dir}/tools/app_framedump.py" \
   "${bin_prefix}/eagine-app-framedump"
"${src_dir}/tools/app_framedump.py" \
	--print-bash-completion "${bco_prefix}/eagine-app-framedump"

cp "${src_dir}/source/app/obj-to-eagimesh.py" \
   "${bin_prefix}/eagine-obj-to-eagimesh"

cp "${src_dir}/source/app/blender-bake-light.py" \
   "${bin_prefix}/eagine-blender-bake-light"

cp "${src_dir}/source/app/blender-bake-to-vertex.py" \
   "${bin_prefix}/eagine-blender-bake-to-vertex"

cp "${src_dir}/source/app/blender-export-mesh.py" \
   "${bin_prefix}/eagine-blender-export-mesh"

cp "${src_dir}/source/app/blender-render-cubemap.py" \
   "${bin_prefix}/eagine-blender-render-cubemap"

cp "${src_dir}/source/app/blender-make-vertex-pivots.py" \
   "${bin_prefix}/eagine-blender-make-vertex-pivots"

# ------------------------------------------------------------------------------
mkdir -p "${pkg_dir}/DEBIAN"
cat << CONTROL > "${pkg_dir}/DEBIAN/control"
Package: eagine-app-tools
Version: @PKG_VERSION@
Architecture: @PKG_ARCH@
Installed-Size: $(du -k -s "${pkg_dir:-.}" | cut -f 1)
Depends: python3,python3-pip
Maintainer: Matus Chochlik <chochlik@gmail.com>
Description: Collection of command-line utilities useful EAGine with applications.
CONTROL
# ------------------------------------------------------------------------------
